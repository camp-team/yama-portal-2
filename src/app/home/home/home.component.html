<div class="home">
  <div class="home__sticky">
    <div class="home__mountain-name">
      <h1>天城山</h1>
    </div>
    <div class="home__map">
      <iframe
        src="https://www.google.com/maps/d/embed?mid=1-Uov2ANGKaYKUV207hf7LgPu6XZFnwzp"
        width="100%"
        height="200"
      ></iframe>
    </div>
    <div *ngIf="user$ | async" class="home__formLink">
      <button
        mat-fab
        color="primary"
        routerLink="/form"
        routerLinkActive="active"
        class="home__formLink__button"
      >
        <mat-icon inline>comment</mat-icon>
      </button>
    </div>
  </div>

  <div>
    <app-filter></app-filter>
  </div>

  <form class="search" (ngSubmit)="routeSearch(searchControl.value)">
    <input
      class="search__input"
      type="text"
      placeholder="投稿内容を検索"
      [formControl]="searchControl"
    />
    <button class="search__button">
      <mat-icon>search</mat-icon>
    </button>
  </form>

  <div class="timeLine">
    <mat-card *ngFor="let item of posts" class="card">
      <mat-card-header>
        <div
          mat-card-avatar
          [style.background-image]="'url(' + item.user.avaterURL + ')'"
          class="card__avatar"
        ></div>
        <mat-card-title>{{ item.user.name }}</mat-card-title>
        <mat-card-subtitle>{{ item.category }}</mat-card-subtitle>
      </mat-card-header>
      <a href="{{ item.imageURL }}">
        <div
          *ngIf="item.imageURL"
          [style.background-image]="'url(' + item.imageURL + ')'"
          class="card__image"
          alt="image"
        ></div>
      </a>
      <mat-card-content class="card__body">
        <p class="card__content">{{ item.content }}</p>
        <p class="card__date">
          {{ item.createdAt | date: 'yyyy/MM/dd HH:mm' }}
        </p>
      </mat-card-content>
    </mat-card>
  </div>
  <div
    infiniteScroll
    [infiniteScrollDistance]="2"
    [infiniteScrollThrottle]="20"
    [infiniteScrollContainer]="uiService.scrollWrapperElement"
    (scrolled)="addSearch()"
  ></div>
  <mat-progress-spinner
    class="loading"
    *ngIf="loading"
    mode="indeterminate"
    color="primary"
    [diameter]="40"
  ></mat-progress-spinner>
</div>
